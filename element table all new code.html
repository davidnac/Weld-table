<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Searchable Welding Wire Table</title>
    <style>

        @font-face {
              font-family: 'Montserrat-Medium';
              src: url('Montserrat/static/Montserrat-Medium.ttf') format('truetype');
              font-weight: 500; /* Medium weight */
              font-style: normal;
          }
          body {
              font-family: Arial, sans-serif;
              font-family: 'Montserrat-Medium', sans-serif;
              margin: 20px;
              background-color: #f4f4f4;
              text-align: center;
          }
        h2 {
            margin-bottom: 25px;
            margin-top: 30px;
        }
        input {
            padding: 6px 0;
            width:90%;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 5px;
            height: 15px;
            text-align: center;
        }

        .controls{
          display: flex;
          justify-content: center; /* Centers horizontally */
          align-items: center;     /* Centers vertically */
          margin-bottom: 20px;
          gap: 16px;
       }

        .table-container {
            width: 98%;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            height: 64vh; /* Fixed height of the table container */
            overflow-y: auto; /* Enable vertical scrolling */
            margin-bottom: 22px;
        }

        .table-container.query{
            height: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 15px 7px;
            font-size: 14px;
            border-left: 1px solid #ddd; /* Adds left border */
            border-right: 1px solid #ddd; /* Adds right border */
            border-top: none; /* Removes top border */
            border-bottom: none;
        }

        td{
          position: relative; /* Ensure relative positioning for absolute elements */
        }

        table th:not(:last-child),
        table td:not(:last-child) {
            text-align: center;
        }

        th {
            background-color: #98D8EF;
            color: white;
            align-items: center;
            text-align: center;
            cursor: pointer;
            position: sticky;
            top: 0; /* Make header sticky */
            z-index: 3; /* Ensure header stays above table content - was 1 i changed to 0 */
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .sort-icon {
            margin-left: 5px;
            font-size: 12px;
        }
        tr:hover {
            background-color: #e0f7fa;
        }

        br {
            display: block;
            content: "";
            margin-bottom: 10px; /* Adjust the space */
        }
        .highlighted {
            background-color: #FFD95F !important;
        }

        .section a{
          color: #3674B5;
          margin-left: 12px;
          margin-right: 12px;
          text-align: center;
          font-size: 14px;
          text-transform: uppercase;
          text-decoration: none;
       }

       ul {
         list-style-type: none;
         text-align: left;
         padding-left: 25px; /* remove default padding */
      }
       li {
         padding: 5px 0;
         font-size: 13px;
       }
       h4{
         padding-left: 25px;
       }

       .clearButton{
          display: none;
          cursor: pointer;
          font-size: 26px;
          color: gray;
          padding-left: 6px;
       }

       .btn {
        background-color: #578FCA;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        width: 160px;
        font-size: 15px;
        font-weight: bold;
      }
      .btn:hover{
        background-color: #493D9E;
      }
      .clear-btn {
        background-color: #ff4c4c;
        width: 120px;
      }
      .clear-btn:hover {
        background-color: #cc0000;
      }
      .custom-file-upload {
        display: inline-block;
        padding: 8px 15px;
        background-color: #4caf50;
        color: white;
        font-size: 15px;
        font-weight: bold;
        text-align: center;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }
      .export-btn{
        background-color: #4caf50;
      }
      .custom-file-upload:hover {
        background-color: #45a049;
      }
      .export-btn:hover {
        background-color: #45a049;
      }


      input[type="file"] {
        display: none;
      }
      input.small{
        width: 60px;
      }
      .highlight {
        background-color: #ffd95f !important; /* Change color as needed */
      }


      .error-message {
          color: white;
          background-color: #d9534f;
          font-size: 12px;
          display: none; /* Hidden by default */
          position: absolute;
          left: 100%; /* Position to the right of input */
          top: 50%;
          transform: translateY(-50%); /* Center vertically */
          margin-left: 0; /* Space between input and message */
          padding: 6px 10px;
          border-radius: 4px;
          white-space: nowrap;
          z-index: 10;
      }

      .error-message::before {
          content: "";
          position: absolute;
          top: 50%;
          left: -3%; /* Attach the arrow to the left side of the message */
          transform: translateY(-50%);
          width: 0;
          height: 0;
          border-top: 9px solid transparent;
          border-bottom: 9px solid transparent;
          border-right:9px solid #d9534f;
        }

      /* Show error message only when the "show" class is added */
      .error-message.show {
          display: inline-block;
      }


      .modal-content-periodic-table .table {
              display: grid;
              grid-template-columns: repeat(18, 1fr);
              column-gap: 5px;
              row-gap: 5px;
              margin-top: 30px;
          }
        .modal-content-periodic-table .element {
              width: 55px;
              height: 55px;
              background: white;
              border: 1px solid #ccc;
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              text-align: center;
              padding: 5px;
              border-radius: 5px;
              box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
              transition: transform 0.2s ease, background-color 0.2s ease;
              cursor: pointer;
          }
          .modal-content-periodic-table .element:hover {
              transform: translateY(-5px);
              background-color: #e0e0e0;
          }
          .modal-content-periodic-table .empty {
              visibility: hidden;
          }
          .modal-content-periodic-table .symbol {
              font-size: 1.5em;
              font-weight: bold;
          }
          .modal-content-periodic-table .name {
              font-size: 0.6em;
          }
          .modal-content-periodic-table .element.selected {
              background-color: #98D8EF;
              border-color: #ffd95f;
          }
      .modal {
        display: none;
        position: fixed;
        z-index: 4;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .modal-content-periodic-table {
        background: white;
        padding: 20px;
        border-radius: 10px;
        max-width: 100%;
        min-height: 50vh;
        position: relative;
    }
    .modal-content-periodic-table .close {
        position: absolute;
        top: 10px;
        right: 15px;
        cursor: pointer;
        font-size: 30px;
    }

    </style>


</head>
<body>

    <h2>Search Material By Chemical Composition</h2>
    <div class="controls">
        <label for="sensitivity">Sensitivity, %:</label>
        <input class="small" type="number" id="sensitivity" min="0" max="100" value="15">
        <button class="btn clear-btn" onclick="clearInputs()">Clear All</button>
        <button class="btn toggle-btn" id="toggleButton" onclick="toggleBalanceValues()">Toggle Balances</button>
        <button class="btn search-btn" onclick="filterTable()">Search Similar</button>
        <button class="btn PeriodicTableModal" >Open Periodic Table</button>
        <button class="btn insert-btn" id="saveButton">Insert to Table</button>
        <button class="btn save-btn" onclick="saveHtmlToFile()">Save file</button>
        <button class="btn export-btn" id="exportCSV">Export to CSV</button>
        <label for="importCSV" class="custom-file-upload">
          <span>Import a CSV file</span>
          <input type="file" id="importCSV">
        </label>
  </div>


     <div class="table-container query">
        <table id="query-table">
            <thead>
              <tr>
                <th class="maxWide">Material</th>
                <th>Nickel</th>
                <th>Cobalt</th>
                <th>Chromium</th>
                <th>Molybdenum</th>
                <th>Niobium</th>
                <th>Titanium</th>
                <th>Aluminum</th>
                <th>Tungsten</th>
                <th>Iron</th>
                <th>Carbon</th>
                <th>Manganese</th>
                <th>Silicon</th>
                <th>Tin</th>
                <th>Vanadium</th>
                <th>Zirconium</th>
                <th>Boron</th>
                <th>Silver</th>
                <th>Copper</th>
                <th>Zinc</th>
                <th>Magnesium</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td class="maxWide">
                  <input type="text" id="materialSearch" placeholder="Search material...">
                </td>
                <td>
                  <input type="text" class="filter" data-col="1" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="2" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="3" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="4" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="5" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="6" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="7" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="8" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="9" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="10" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="11" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="12" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="13" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="14" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="15" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="16" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="17" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="18" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="19" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="20" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
              </tr>
            </tbody>
          </table>
    </div>

    <div class="table-container">
        <table id="data-table">
            <thead>


          <tr>
            <th onclick="sortTable(0)">
              Material <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(1)">
              Nickel (Ni) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(2)">
              Cobalt (Co) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(3)">
              Chromium (Cr) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(4)">
              Molybdenum (Mo) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(5)">
              Niobium (Nb) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(6)">
              Titanium (Ti) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(7)">
              Aluminum (Al) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(8)">
              Tungsten (W) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(9)">
              Iron (Fe) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(10)">
              Carbon (C) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(11)">
              Manganese (Mn) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(12)">
              Silicon (Si) % <span class="sort-icon">⇅</span>
            </th>

            <th onclick="sortTable(13)">
              Tin (Sn) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(14)">
              Vanadium (V) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(15)">
              Zirconium (Zr) % <span class="sort-icon">⇅</span>
            </th>

            <th onclick="sortTable(16)">
              Boron (B) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(17)">
              Silver (Ag) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(18)">
              Copper (Cu) %<span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(19)">
              Zinc (Zn) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(20)">
              Magnesium (Mg) % <span class="sort-icon">⇅</span>
            </th>
          </tr>


            </thead>
            <tbody>

          <tr>
            <td>CRES 304</td>
            <td>8.0 - 10.5</td>
            <td>-</td>
            <td>18.0 - 20.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Bal.</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 308</td>
            <td>11.0</td>
            <td>-</td>
            <td>19.0 - 21.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Bal.</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 316</td>
            <td>10.0 - 14.0</td>
            <td>-</td>
            <td>16.0 - 18.0</td>
            <td>2.0 - 3.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Bal.</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 321</td>
            <td>9.0 - 12.0</td>
            <td>-</td>
            <td>17.0 - 19.0</td>
            <td>-</td>
            <td>5.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Bal.</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 347</td>
            <td>9.0 - 12.0</td>
            <td>-</td>
            <td>17.0 - 19.0</td>
            <td>-</td>
            <td>10.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>62.0</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 410</td>
            <td>0.75</td>
            <td>-</td>
            <td>11.5 - 13.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>88.0</td>
            <td>0.08 - 0.15</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>René 41</td>
            <td>54.0</td>
            <td>10.0 - 12.0</td>
            <td>18.0 - 20.0</td>
            <td>9.0 - 10.5</td>
            <td>-</td>
            <td>3.0 - 3.3</td>
            <td>1.4 - 1.6</td>
            <td>-</td>
            <td>5.0</td>
            <td>0.05 - 0.12</td>
            <td>0.003 - 0.010</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Rene 77</td>
            <td>62.0</td>
            <td>14-16</td>
            <td>14-16</td>
            <td>4-5</td>
            <td>-</td>
            <td>2.5-3.2</td>
            <td>3.8-4.8</td>
            <td>-</td>
            <td>-</td>
            <td>0.08-0.15</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>René 80</td>
            <td>56.0</td>
            <td>9.5 - 10.5</td>
            <td>19.0 - 21.0</td>
            <td>9.0 - 10.0</td>
            <td>-</td>
            <td>2.6 - 3.1</td>
            <td>1.4 - 1.6</td>
            <td>-</td>
            <td>5.0</td>
            <td>0.05 - 0.10</td>
            <td>0.003 - 0.010</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Waspaloy</td>
            <td>53.0 - 59.0</td>
            <td>9.0 - 11.0</td>
            <td>19.0 - 21.0</td>
            <td>1.5 - 2.5</td>
            <td>-</td>
            <td>3.0 - 3.5</td>
            <td>1.0 - 1.5</td>
            <td>-</td>
            <td>1.0 - 5.0</td>
            <td>0.05 - 0.15</td>
            <td>0.003 - 0.010</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>

          <tr>
            <td>Inconel 100</td>
            <td>64.0</td>
            <td>15-16.5</td>
            <td>9-11</td>
            <td>3-4</td>
            <td>-</td>
            <td>4.3-4.7</td>
            <td>4.8-5.2</td>
            <td>-</td>
            <td>≤1</td>
            <td>0.17-0.23</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 600</td>
            <td>72.0</td>
            <td>-</td>
            <td>14-17</td>
            <td>-</td>
            <td>-</td>
            <td>0.3</td>
            <td>0.2-0.4</td>
            <td>-</td>
            <td>6-10</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 601</td>
            <td>58-63</td>
            <td>1.0</td>
            <td>21-25</td>
            <td>≤1</td>
            <td>-</td>
            <td>0.3-1.5</td>
            <td>1-1.7</td>
            <td>-</td>
            <td>17.0</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 602</td>
            <td>63.0</td>
            <td>1.5</td>
            <td>24.0-26.0</td>
            <td>8.5-9</td>
            <td>-</td>
            <td>0.15-0.25</td>
            <td>1.8-2.4</td>
            <td>-</td>
            <td>≤3</td>
            <td>0.1</td>
            <td>0.1</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 625</td>
            <td>58.0</td>
            <td>1.0</td>
            <td>20-23</td>
            <td>8-10</td>
            <td>3.15-4.15</td>
            <td>0.4</td>
            <td>0.4</td>
            <td>-</td>
            <td>5.0</td>
            <td>0.1</td>
            <td>0.5</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 713</td>
            <td>76.0</td>
            <td>0.5</td>
            <td>12.5-13.5</td>
            <td>4.2-4.8</td>
            <td>-</td>
            <td>0.5-0.8</td>
            <td>5.5-6.5</td>
            <td>-</td>
            <td>76.0</td>
            <td>0.08-0.2</td>
            <td>0.1</td>
            <td>0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 718</td>
            <td>50.0-55.0</td>
            <td>1.0</td>
            <td>17.0-21.0</td>
            <td>2.8-3.3</td>
            <td>4.75-5.5</td>
            <td>0.65-1.15</td>
            <td>0.2-0.8</td>
            <td>-</td>
            <td>23.0</td>
            <td>0.1</td>
            <td>0.3</td>
            <td>0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Hastelloy X</td>
            <td>47.5-52.0</td>
            <td>1.5</td>
            <td>20.5-23</td>
            <td>8-10</td>
            <td>-</td>
            <td>-</td>
            <td>0.5</td>
            <td>-</td>
            <td>17.0-20.0</td>
            <td>0.05-0.15</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Hastelloy W</td>
            <td>56.0</td>
            <td>5.0</td>
            <td>4.5-7</td>
            <td>24.0-28.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>4.0-6.0</td>
            <td>5.0</td>
            <td>0.05-0.15</td>
            <td>1.0</td>
            <td>0.2</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>L605</td>
            <td>10.0</td>
            <td>49.0-53.0</td>
            <td>19-21</td>
            <td>1.0-2.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>14.0-16.0</td>
            <td>3.0</td>
            <td>0.05-0.15</td>
            <td>1.0</td>
            <td>0.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Haynes 188</td>
            <td>22.0</td>
            <td>37.0</td>
            <td>20.0-24.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>13.0-16.0</td>
            <td>3.0</td>
            <td>0.05-0.15</td>
            <td>1.3</td>
            <td>0.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Haynes 230</td>
            <td>57.0</td>
            <td>5.0</td>
            <td>20.0-24.0</td>
            <td>1.5-3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>14.0</td>
            <td>3.0</td>
            <td>0.05-0.15</td>
            <td>0.3-0.6</td>
            <td>0.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>X-750</td>
            <td>70.0</td>
            <td>1.0</td>
            <td>14.0-17.0</td>
            <td>0.7-1.2</td>
            <td>0.7-1.2</td>
            <td>2.25-2.75</td>
            <td>0.4-1</td>
            <td>-</td>
            <td>5-9</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Greek Ascoloy</td>
            <td>-</td>
            <td>-</td>
            <td>12.0-14.0</td>
            <td>-</td>
            <td>-</td>
            <td>2.75-3.25</td>
            <td>-</td>
            <td>-</td>
            <td>84.0</td>
            <td>0.15-0.2</td>
            <td>0.5</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>17-4 PH</td>
            <td>3.0-5.0</td>
            <td>-</td>
            <td>15.0-17.5</td>
            <td>-</td>
            <td>-</td>
            <td>0.15-0.45</td>
            <td>-</td>
            <td>-</td>
            <td>63.0</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>15-5 PH</td>
            <td>3.5-5.5</td>
            <td>-</td>
            <td>14.0-15.5</td>
            <td>-</td>
            <td>-</td>
            <td>0.9</td>
            <td>-</td>
            <td>-</td>
            <td>65.0</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>A286</td>
            <td>24.0-27.0</td>
            <td>-</td>
            <td>13.5-16</td>
            <td>1.0-1.5</td>
            <td>-</td>
            <td>1.9-2.3</td>
            <td>0.1-0.5</td>
            <td>-</td>
            <td>56.0</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>C263</td>
            <td>52.0</td>
            <td>20.0</td>
            <td>19-21</td>
            <td>5.6-6.1</td>
            <td>-</td>
            <td>2-2.4</td>
            <td>0.6</td>
            <td>-</td>
            <td>52.0</td>
            <td>0.0</td>
            <td>0.6</td>
            <td>0.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>C276</td>
            <td>60.0</td>
            <td>2.5</td>
            <td>14.5-16.5</td>
            <td>15-17</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>3-4.5</td>
            <td>4-7</td>
            <td>0.0</td>
            <td>1.0</td>
            <td>0.1</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Steel 4340</td>
            <td>-</td>
            <td>-</td>
            <td>0.7-0.9</td>
            <td>0.2-0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>98.0</td>
            <td>0.38-0.43</td>
            <td>0.6-0.8</td>
            <td>0.15-0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Steel 4130</td>
            <td>-</td>
            <td>-</td>
            <td>0.8-1.1</td>
            <td>0.15-0.25</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>98.0</td>
            <td>0.28-0.33</td>
            <td>0.4-0.6</td>
            <td>0.15-0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Marm-200</td>
            <td>72.0</td>
            <td>10.0</td>
            <td>9.0</td>
            <td>2.0</td>
            <td>-</td>
            <td>5.0</td>
            <td>2.0</td>
            <td>-</td>
            <td>-</td>
            <td>0.1</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Coast Metal 64</td>
            <td>5</td>
            <td>43.6</td>
            <td>28</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>21</td>
            <td>-</td>
            <td>0.85</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>1</td>
            <td>-</td>
            <td>0.05</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Tribaloy 800</td>
            <td>-</td>
            <td>50.6</td>
            <td>17.5</td>
            <td>28.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>3.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Stellite 31 (X40)</td>
            <td>10.5</td>
            <td>51.0</td>
            <td>26.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>7.5</td>
            <td>3.0</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 8Al 1Mo 1V</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>1.0</td>
            <td>-</td>
            <td>90.0</td>
            <td>8.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 6Al 4V ELI</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>90.0</td>
            <td>6.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>4.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 6Al 4V</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>90.0</td>
            <td>6.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>4.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 6Al 2Sn 4Zr 2Mo</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>2.0</td>
            <td>-</td>
            <td>86.0</td>
            <td>6.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>2.0</td>
            <td>-</td>
            <td>4.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 15V 3Cr 3Sn 3Al</td>
            <td>-</td>
            <td>-</td>
            <td>3.0</td>
            <td>-</td>
            <td>-</td>
            <td>76.0</td>
            <td>3.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>3.0</td>
            <td>15.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Silver Flo 55</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>2.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>55.0</td>
            <td>21.0</td>
            <td>22.0</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Silver Flo 56 (AMS 4763)</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>5.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>56.0</td>
            <td>22.0</td>
            <td>17.0</td>
            <td>-</td>
          </tr>
            <tr>
              <td>BAg-24 (AMS 4788)</td><td>2.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>50.0</td><td>20.0</td><td>28.0</td>  <td>-</td>
              </tr>
              <tr>
                <td>BAg-13 (AMS 4772)</td><td>1.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>54.0</td><td>40.0</td><td>5.0</td>  <td>-</td>
              </tr>
              <tr>
                <td>BAg-13a (AMS 4765)</td><td>2.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>56.0</td><td>42.0</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-5 (AMS 4782)</td><td>71.0</td><td>-</td><td>19.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>10.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-1 (AMS 4775)</td><td>73.0</td><td>-</td><td>14.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>4.5</td><td>0.8</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>-</td><td>3.0</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-1a (AMS 4776)</td><td>74.0</td><td>-</td><td>14.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-2 (AMS 4777)</td><td>82.4</td><td>-</td><td>7.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>3.0</td><td>-</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>-</td><td>3.1</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-3 (AMS 4778)</td><td>92.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>-</td><td>3.0</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-4 (AMS 4779)</td><td>94.6</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>3.5</td><td>-</td><td>-</td><td>-</td><td>1.9</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
            <tr>
              <td>Al 2024</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>93</td><td>-</td><td>0.5</td><td>-</td><td>-</td><td>0.5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>4.9</td><td>-</td><td>-</td>
            </tr>
              <tr>
                <td>Al 6061</td><td>-</td><td>-</td><td>0.2</td><td>-</td><td>-</td><td>-</td><td>97.9</td><td>-</td><td>-</td><td>-</td><td>-</td><td>0.6</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>0.28</td><td>-</td><td>1</td>
              </tr>
              <tr>
                <td>Al 7075</td><td>-</td><td>-</td><td>0.2</td><td>-</td><td>-</td><td>-</td><td>91</td><td>-</td><td>-</td><td>-</td><td>-</td><td>0.6</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>1.4</td><td>5.6</td><td>2.1</td>
              </tr>
              <tr>
                <td>Al A413</td><td>0.5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>94</td><td>-</td><td>-</td><td>-</td><td>0.35</td><td>12</td><td>0.15</td><td>-</td><td>-</td><td>-</td><td>-</td><td>1</td><td>-</td><td>0.1</td>
            </tr>
            <tr>
              <td>Al 4043</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>93.9</td><td>-</td><td>-</td><td>-</td><td>-</td><td>5.2</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td>
            </tr>
            <tr>
              <td>Al 5052</td><td>-</td><td>-</td><td>0.25</td><td>-</td><td>-</td><td>-</td><td>97.2</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>2.5</td>
            </tr>
            <tr>
              <td>Al 5Si 1.3Cu 0.5Mg</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>93.2</td><td>-</td><td>-</td><td>-</td><td>-</td><td>5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>1.3</td><td>-</td><td>0.5</td>
            </tr>
          </tbody>

            </tbody>
        </table>

    </div>

    <div id="modal-periodic-table" class="modal" style="display:none;">
        <div class="modal-content-periodic-table">
            <span class="close">&times;</span>
            <div class="table" id="periodic-table"></div>
        </div>
    </div>

    <script>


///////////FIND FILTER COLUMN BY NAME, SO ORDER OF ELEMENTS IN TABLE IS UNIMPORTANT//////////////////////////

          // Add event listener for clicks on the inputs
        document.querySelectorAll('.filter').forEach(input => {
          input.addEventListener('click', function() {
            const td = this.closest('td');  // Find the <td> containing the input
            const cellIndex = Array.from(td.parentElement.children).indexOf(td);  // Get column index

            //console.log(` Column: ${cellIndex}`);
            const thText = document.querySelectorAll('table thead tr th')[cellIndex].textContent;
            //console.log( thText);
           const filterIndex = searchHeader(thText)
           console.log(filterIndex);
          });
        });

        function searchHeader(thText) {
          const headers = document.querySelectorAll('#data-table thead th');

          for (let i = 0; i < headers.length; i++) {
            if (headers[i].textContent.toLowerCase().includes(thText.toLowerCase())) {
              return i;  // 1-based index of the header
            }
          }

          return null; // Return null if no header is found
        }

///////////FIND FILTER COLUMN BY NAME, SO ORDER OF ELEMENTS IN TABLE IS UNIMPORTANT//////////////////////////








        document.addEventListener("DOMContentLoaded", function () {

          //search bar
        document.getElementById("materialSearch").addEventListener("input", function () {

            clearFilters();//clear filters before searching
            let searchValue = this.value.toLowerCase();
            document.querySelectorAll("#data-table tbody tr")
              .forEach((row) => {
                let material = row.cells[0].textContent.toLowerCase();
                row.style.display = material.includes(searchValue)
                  ? ""
                  : "none";
              });
          });
       });


      //filter table
      function filterTable() {

        clearSearch(); // clear search bar before filtering

        let filters = document.querySelectorAll(".filter");
        let rows = document.querySelectorAll(
          "#data-table tbody tr"
        );

        let sensitivity =
          parseFloat(document.getElementById("sensitivity").value) || 1;

        rows.forEach((row) => {
          let cells = row.getElementsByTagName("td");
          let showRow = true;

          filters.forEach((filter) => {
            let colIndex = filter.getAttribute("data-col");
            let filterValue = filter.value.trim();
            let cellText = cells[colIndex].textContent.trim();

            // If filter is empty, ignore filtering for this column
            if (filterValue === "") return;

            // Ignore rows where the cell is just "-"
            if (cellText === "-") {
              showRow = false;
              return;
            }

            let cellValue;
            if (cellText.includes("-")) {
              // Handle range values like "10 - 14"
              let [min, max] = cellText
                .split("-")
                .map((num) => parseFloat(num.trim()));
              if (!isNaN(min) && !isNaN(max)) {
                cellValue = [min, max]; // Store range for filtering
              } else {
                cellValue = parseFloat(cellText); // Fallback in case of malformed data
              }
            } else {
              cellValue = parseFloat(cellText);
            }

            // Ensure valid number input
            if (!isNaN(parseFloat(filterValue))) {
              let lowerBound =
                parseFloat(filterValue) -
                (parseFloat(filterValue) * sensitivity) / 100;
              let upperBound =
                parseFloat(filterValue) +
                (parseFloat(filterValue) * sensitivity) / 100;

              if (Array.isArray(cellValue)) {
                // Filter using both min and max values of the range
                if (cellValue[1] < lowerBound || cellValue[0] > upperBound) {
                  showRow = false;
                }
              } else if (!isNaN(cellValue)) {
                if (cellValue < lowerBound || cellValue > upperBound) {
                  showRow = false;
                }
              }
            }
          });

          row.style.display = showRow ? "" : "none";
        });
      }


      //double click row to copy data
      document.querySelectorAll("#data-table tr").forEach((row) => {
        row.addEventListener("dblclick", function () {
          let cells = this.getElementsByTagName("td");
          let inputs = document.querySelectorAll("#query-table input");

          inputs.forEach((input, index) => {
            let cellText = cells[index] ? cells[index].textContent.trim() : "";

            // First column: copy as-is, Other columns: only copy if it's a number
            if (index === 0) {
              input.value = cellText; // Copy first column as-is
            } else {
              let cellValue = parseFloat(cellText);
              input.value = !isNaN(cellValue) ? cellValue : "";
            }
          });
        });
      });


      let sortDirections = {}; // Store sort directions for each column

      //sort columns
      function sortTable(colIndex) {
        let table = document.getElementById("data-table");
        let tbody = table.querySelector("tbody"); // Ensure tbody is selected
        let rows = Array.from(tbody.rows); // Get only tbody rows (skip the header)


        // Default to descending order if first click, otherwise toggle
        if (sortDirections[colIndex] === undefined) {
            sortDirections[colIndex] = false; // Start with descending order
        } else {
            sortDirections[colIndex] = !sortDirections[colIndex]; // Toggle order on next click
        }

        let isAscending = sortDirections[colIndex];

        rows.sort((rowA, rowB) => {
            let cellA = rowA.cells[colIndex].textContent.trim();
            let cellB = rowB.cells[colIndex].textContent.trim();

            let valueA = parseCellValue(cellA, rowA, colIndex);
            let valueB = parseCellValue(cellB, rowB, colIndex);

            return isAscending ? valueA - valueB : valueB - valueA;
        });

            // Clear tbody and reappend sorted rows
            tbody.innerHTML = "";
            rows.forEach(row => tbody.appendChild(row));
    }


        // Parse cell value to handle ranges and other types of values
        function parseCellValue(value, row = null, colIndex = null) {
            value = value.trim();

            if (value === "-") return 0; // "-" is treated as zero

            if (value.toLowerCase() === "bal." || value.toLowerCase() === "balance") {
                return calculateBalance(row, colIndex); // Compute balance dynamically
            }

            // Remove all spaces from the range
            let cleanValue = value.replace(/\s+/g, '');

            // Check if the value is a range (e.g., "9.0-12.0")
            if (cleanValue.includes('-') && /^[0-9]+(\.[0-9]+)?-[0-9]+(\.[0-9]+)?$/.test(cleanValue)) {
                let parts = cleanValue.split('-').map(Number);
                // Calculate and return the average of the two values in the range
                return (parts[0] + parts[1]) / 2; // Average of range
            }

            // For regular numbers or any other text
            return parseFloat(value) || 0; // Convert to number, default to 0
        }

        // Calculate balance from row by summing other cell values
        function calculateBalance(row, colIndex) {
            let total = 0;
            for (let i = 0; i < row.cells.length; i++) {
                if (i !== colIndex) { // Exclude balance column itself
                    let cellValue = row.cells[i].textContent.trim();
                    let numValue = parseCellValue(cellValue); // Parse each cell's value
                    total += numValue;
                }
            }
            return 100 - total; // Balance is 100 - SUM(other values)
        }



            //clear all inputs
            function clearInputs() {
                document.querySelectorAll("#query-table input").forEach((input) => {
                    input.value = "";

                    // Clear error messages by removing the "show" class
                    let errorMessage = input.nextElementSibling; // Get the associated error message span
                    if (errorMessage && errorMessage.classList.contains("show")) {
                        errorMessage.classList.remove("show"); // Hide the error message
                    }
                });


              document.querySelectorAll("#data-table tr")
                .forEach((row) => (row.style.display = ""));
            }

            function clearSearch(){
              let searchBar = document.querySelector("#materialSearch");
              searchBar.value = "";
            }

            function clearFilters(){
              let elementFilters = document.querySelectorAll("#query-table .filter").forEach((element) => (element.value = ""));
              let validationMessages = document.querySelectorAll("#query-table span").forEach((element) => (element.classList.remove("show")));
            }



            //Highlight row on click
            document.querySelectorAll("#data-table tbody tr")
              .forEach((row) => {
                row.addEventListener("click", function (event) {
                  let isHighlighted = this.classList.contains("highlight");

                  // Remove highlight from all rows
                  document.querySelectorAll("#data-table tbody tr")
                    .forEach((r) => r.classList.remove("highlight"));

                  // Toggle highlight on the clicked row
                  if (!isHighlighted) {
                    this.classList.add("highlight");
                  }

                  // Stop click from propagating to the document listener
                  event.stopPropagation();
                });
              });



      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("saveButton")
          .addEventListener("click", function () {
            let materialName = document
              .getElementById("materialSearch")
              .value.trim();
            if (!materialName) {
              alert("Please enter a material name.");
              return;
            }

            let dataTable = document
              .getElementById("data-table")
              .getElementsByTagName("tbody")[0];
            let rows = dataTable.getElementsByTagName("tr");
            let found = false;

            // Get input values from query-table
            let inputs = document.querySelectorAll("#query-table .filter");
            let values = Array.from(inputs).map(
              (input) => input.value.trim() || "-"
            );

            for (let i = 1; i < rows.length; i++) {
              // Start from 1 to skip headers
              let row = rows[i];
              let firstCell = row.cells[0];

              if (firstCell.textContent.trim() === materialName) {
                // ✅ Update existing row (ALL columns)
                for (let j = 0; j < values.length; j++) {
                  row.cells[j + 1].textContent = values[j]; // Skip material column
                }
                found = true;
                break;
              }
            }

            if (!found) {
              // ✅ Add new row
              let newRow = dataTable.insertRow();

              // Insert material name
              let nameCell = newRow.insertCell(0);
              nameCell.textContent = materialName;

              // Insert all values
              values.forEach((value) => {
                let cell = newRow.insertCell();
                cell.textContent = value;
              });
            }
          });
      });


      //export table to csv
      document.getElementById("exportCSV").addEventListener("click", function () {
          let dataTable = document.getElementById("data-table");
          let rows = dataTable.getElementsByTagName("tr");
          let csvContent = [];

          for (let i = 0; i < rows.length; i++) {
            let row = rows[i];
            let cells =
              row.getElementsByTagName("th").length > 0
                ? row.getElementsByTagName("th")
                : row.getElementsByTagName("td");
            let rowData = Array.from(cells)
              .map((cell) => `"${cell.textContent.trim()}"`)
              .join(",");
            csvContent.push(rowData);
          }

          let csvBlob = new Blob([csvContent.join("\n")], { type: "text/csv" });
          let link = document.createElement("a");
          link.href = URL.createObjectURL(csvBlob);
          link.download = "materials database.csv";
          link.click();
        });



        document.getElementById("importCSV").addEventListener("change", function (event) {
                  let file = event.target.files[0];
                  if (!file) return;

                  let reader = new FileReader();
                  reader.onload = function (e) {
                      loadCSVData(e.target.result);
                       event.target.value = ""; // Reset input so the same file can be selected again
                  };
                  reader.readAsText(file);
              });


              function loadCSVData(csvText) {

                        let csvData = csvText.split("\n").map(row => row.split(","))
                        .filter((row, index) => index > 0 && row.join("").trim() !== ""); // Skip the header row and empty rows

                        let dataTable = document.getElementById("data-table").getElementsByTagName("tbody")[0];

                        dataTable.innerHTML = ""; // Clear old data

                        csvData.forEach(rowData => {
                            let newRow = dataTable.insertRow();
                            rowData.forEach(cellData => {
                                let cell = newRow.insertCell();
                                cell.textContent = cellData.replace(/"/g, ""); // Remove quotes from CSV
                            });
                        });
                    }



              //save new html file
      function saveHtmlToFile() {
        // Get the HTML content of the page
        const htmlContent = document.documentElement.outerHTML;

                // Get today's date in dd/mm/yyyy format
        const today = new Date();
        const day = String(today.getDate()).padStart(2, '0');
        const month = String(today.getMonth() + 1).padStart(2, '0'); // Months are 0-based
        const year = today.getFullYear();
        const dateStr = `${day}-${month}-${year}`;

        // Use a default file name (you can change this if needed)
        const fileName = `page_${dateStr}.html`;

        // Add the DOCTYPE declaration before the HTML content
        const doctype = `<!DOCTYPE html>\n`;
        const fullHtmlContent = doctype + htmlContent;

        // Create a Blob from the HTML content
        const blob = new Blob([fullHtmlContent], { type: "text/plain" });

        // Create an anchor element to trigger the download
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = fileName; // Name of the file to save

        // Trigger the download
        link.click();
      }



      //Shrink header columns on click, to allow easier edit
      document.addEventListener("DOMContentLoaded", function () {
          const elementMap = {
              "Nickel": "Ni",
              "Cobalt": "Co",
              "Chromium": "Cr",
              "Molybdenum": "Mo",
              "Niobium": "Nb",
              "Titanium": "Ti",
              "Aluminum": "Al",
              "Tungsten": "W",
              "Iron": "Fe",
              "Carbon": "C",
              "Manganese": "Mn",
              "Silicon": "Si",
              "Tin": "Sn",
              "Vanadium": "V",
              "Zirconium": "Zr",
              "Boron": "B",
              "Silver": "Ag",
              "Copper": "Cu",
              "Zinc": "Zn",
              "Magnesium": "Mg"
          };

          const tableHeaders = document.querySelectorAll("#query-table th");

          tableHeaders.forEach(header => {
              header.addEventListener("click", function () {
                  const fullName = this.textContent;

                  if (elementMap[fullName]) {
                      this.textContent = elementMap[fullName];
                      this.style.width = "20px";

                  } else {
                      const shortName = Object.values(elementMap).find(short => short === fullName);
                      if (shortName) {
                          const longName = Object.keys(elementMap).find(key => elementMap[key] === shortName);
                          this.textContent = longName;
                      }
                  }
              });
          });
      });


      //validation input
      function validateInput(input) {
          const firstColumn = input.closest("tr").querySelector("td:first-child input"); // First column input
          if (input === firstColumn) return; // Skip validation for first column

          const value = input.value.trim();
          const errorMessage = input.nextElementSibling;
          const validNumberRegex = /^(\d{1,2}(\.\d+)?|100)$/; // Matches numbers from 0 to 100, including decimals
          const validRangeRegex = /^(\d{1,2}(\.\d+)?|100) *- *(\d{1,2}(\.\d+)?|100)$/; // Matches range like 1 - 2.5
          const validBal = /^Bal\.$/i; // Matches the word "Bal."

          if (value === "" || validNumberRegex.test(value) || validRangeRegex.test(value) || validBal.test(value)) {
            errorMessage.classList.remove("show"); // Hide when input is valid
            input.style.border = "1px solid #ccc";
            filterTable();
          } else {
            errorMessage.textContent = "Invalid input (0-100, range, or 'Bal.')";
            errorMessage.classList.add("show"); // Show the error message
          }
        }


        // Function to toggle between "Bal." and the calculated value in the table
        function toggleBalanceValues() {
            const table = document.querySelector('#data-table'); // Assuming you're working with a table element
            const cells = table.querySelectorAll('td');

            cells.forEach(cell => {
                if (cell.textContent.trim().toLowerCase() === 'bal.' || cell.textContent.trim().toLowerCase() === 'balance') {

                        // If not converted, calculate and replace it with the value
                        const row = cell.closest('tr');
                        const colIndex = Array.from(cell.parentElement.children).indexOf(cell);
                        const balance = calculateBalance(row, colIndex);
                        cell.textContent = balance.toFixed(2); // Assuming balance is a number to 2 decimal places
                        cell.setAttribute('data-converted', 'true'); // Mark this cell as converted

                }else if (cell.hasAttribute('data-converted')) {
                        // If already converted, revert it back to "Bal."
                        cell.textContent = "Bal.";
                        cell.removeAttribute('data-converted'); // Remove the marker
                    }
            });
        }

        //////////////////MODAL CODE ////////////////////////////

        const elements = [
            { symbol: "H", name: "Hydrogen", row: 1, col: 1 },
            { symbol: "He", name: "Helium", row: 1, col: 18 },

            { symbol: "Li", name: "Lithium", row: 2, col: 1 },
            { symbol: "Be", name: "Beryllium", row: 2, col: 2 },
            { symbol: "B", name: "Boron", row: 2, col: 13 },
            { symbol: "C", name: "Carbon", row: 2, col: 14 },
            { symbol: "N", name: "Nitrogen", row: 2, col: 15 },
            { symbol: "O", name: "Oxygen", row: 2, col: 16 },
            { symbol: "F", name: "Fluorine", row: 2, col: 17 },
            { symbol: "Ne", name: "Neon", row: 2, col: 18 },

            { symbol: "Na", name: "Sodium", row: 3, col: 1 },
            { symbol: "Mg", name: "Magnesium", row: 3, col: 2 },
            { symbol: "Al", name: "Aluminum", row: 3, col: 13 },
            { symbol: "Si", name: "Silicon", row: 3, col: 14 },
            { symbol: "P", name: "Phosphorus", row: 3, col: 15 },
            { symbol: "S", name: "Sulfur", row: 3, col: 16 },
            { symbol: "Cl", name: "Chlorine", row: 3, col: 17 },
            { symbol: "Ar", name: "Argon", row: 3, col: 18 },

            { symbol: "K", name: "Potassium", row: 4, col: 1 },
            { symbol: "Ca", name: "Calcium", row: 4, col: 2 },
            { symbol: "Sc", name: "Scandium", row: 4, col: 3 },
            { symbol: "Ti", name: "Titanium", row: 4, col: 4 },
            { symbol: "V", name: "Vanadium", row: 4, col: 5 },
            { symbol: "Cr", name: "Chromium", row: 4, col: 6 },
            { symbol: "Mn", name: "Manganese", row: 4, col: 7 },
            { symbol: "Fe", name: "Iron", row: 4, col: 8 },
            { symbol: "Co", name: "Cobalt", row: 4, col: 9 },
            { symbol: "Ni", name: "Nickel", row: 4, col: 10 },
            { symbol: "Cu", name: "Copper", row: 4, col: 11 },
            { symbol: "Zn", name: "Zinc", row: 4, col: 12 },
            { symbol: "Ga", name: "Gallium", row: 4, col: 13 },
            { symbol: "Ge", name: "Germanium", row: 4, col: 14 },
            { symbol: "As", name: "Arsenic", row: 4, col: 15 },
            { symbol: "Se", name: "Selenium", row: 4, col: 16 },
            { symbol: "Br", name: "Bromine", row: 4, col: 17 },
            { symbol: "Kr", name: "Krypton", row: 4, col: 18 },

            { symbol: "Rb", name: "Rubidium", row: 5, col: 1 },
            { symbol: "Sr", name: "Strontium", row: 5, col: 2 },
            { symbol: "Y", name: "Yttrium", row: 5, col: 3 },
            { symbol: "Zr", name: "Zirconium", row: 5, col: 4 },
            { symbol: "Nb", name: "Niobium", row: 5, col: 5 },
            { symbol: "Mo", name: "Molybdenum", row: 5, col: 6 },
            { symbol: "Tc", name: "Technetium", row: 5, col: 7 },
            { symbol: "Ru", name: "Ruthenium", row: 5, col: 8 },
            { symbol: "Rh", name: "Rhodium", row: 5, col: 9 },
            { symbol: "Pd", name: "Palladium", row: 5, col: 10 },
            { symbol: "Ag", name: "Silver", row: 5, col: 11 },
            { symbol: "Cd", name: "Cadmium", row: 5, col: 12 },
            { symbol: "In", name: "Indium", row: 5, col: 13 },
            { symbol: "Sn", name: "Tin", row: 5, col: 14 },
            { symbol: "Sb", name: "Antimony", row: 5, col: 15 },
            { symbol: "Te", name: "Tellurium", row: 5, col: 16 },
            { symbol: "I", name: "Iodine", row: 5, col: 17 },
            { symbol: "Xe", name: "Xenon", row: 5, col: 18 },

            { symbol: "Cs", name: "Cesium", row: 6, col: 1 },
            { symbol: "Ba", name: "Barium", row: 6, col: 2 },
            { symbol: "La", name: "Lanthanum", row: 6, col: 3 },
            { symbol: "Hf", name: "Hafnium", row: 6, col: 4 },
            { symbol: "Ta", name: "Tantalum", row: 6, col: 5 },
            { symbol: "W", name: "Tungsten", row: 6, col: 6 },
            { symbol: "Re", name: "Rhenium", row: 6, col: 7 },
            { symbol: "Os", name: "Osmium", row: 6, col: 8 },
            { symbol: "Ir", name: "Iridium", row: 6, col: 9 },
            { symbol: "Pt", name: "Platinum", row: 6, col: 10 },
            { symbol: "Au", name: "Gold", row: 6, col: 11 },
            { symbol: "Hg", name: "Mercury", row: 6, col: 12 },
            { symbol: "Tl", name: "Thallium", row: 6, col: 13 },
            { symbol: "Pb", name: "Lead", row: 6, col: 14 },
            { symbol: "Bi", name: "Bismuth", row: 6, col: 15},
            { symbol: "Po", name: "Polonium", row: 6, col: 16 },
            { symbol: "At", name: "Astatine", row: 6, col: 17 },
            { symbol: "Rn", name: "Radon", row: 6, col: 18 },

            { symbol: "Ce", name: "Cerium", row: 8, col: 4 },
            { symbol: "Pr", name: "Praseodymium", row: 8, col: 5 },
            { symbol: "Nd", name: "Neodymium", row: 8, col: 6 },
            { symbol: "Pm", name: "Promethium", row: 8, col: 7 },
            { symbol: "Sm", name: "Samarium", row: 8, col: 8 },
            { symbol: "Eu", name: "Europium", row: 8, col: 9 },
            { symbol: "Gd", name: "Gadolinium", row: 8, col: 10 },
            { symbol: "Tb", name: "Terbium", row: 8, col: 11 },
            { symbol: "Dy", name: "Dysprosium", row: 8, col: 12 },
            { symbol: "Ho", name: "Holmium", row: 8, col: 13 },
            { symbol: "Er", name: "Erbium", row: 8, col: 14 },
            { symbol: "Tm", name: "Thulium", row: 8, col: 15 },
            { symbol: "Yb", name: "Ytterbium", row: 8, col: 16 },
            { symbol: "Lu", name: "Lutetium", row: 8, col: 17 },

            { symbol: "Th", name: "Thorium", row: 9, col: 4 },
            { symbol: "Pa", name: "Protactinium", row: 9, col: 5 },
            { symbol: "U", name: "Uranium", row: 9, col: 6 },
            { symbol: "Np", name: "Neptunium", row: 9, col: 7 },
            { symbol: "Pu", name: "Plutonium", row: 9, col: 8 },
            { symbol: "Am", name: "Americium", row: 9, col: 9 },
            { symbol: "Cm", name: "Curium", row: 9, col: 10 },
            { symbol: "Bk", name: "Berkelium", row: 9, col: 11 },
            { symbol: "Cf", name: "Californium", row: 9, col: 12 },
            { symbol: "Es", name: "Einsteinium", row: 9, col: 13 },
            { symbol: "Fm", name: "Fermium", row: 9, col: 14 },
            { symbol: "Md", name: "Mendelevium", row: 9, col: 15 },
            { symbol: "No", name: "Nobelium", row: 9, col: 16 },
            { symbol: "Lr", name: "Lawrencium", row: 9, col: 17 }

          ];

        const selectedElements = new Set(["Ag", "Ni", "Co","Ti","V", "Cr","Nb","Mo","Al","Zn","Cu","Fe","Mn"]);
        const table = document.getElementById("periodic-table");

        for (let row = 1; row <= 9; row++) {
            for (let col = 1; col <= 18; col++) {
                const element = elements.find(e => e.row === row && e.col === col);
                const cell = document.createElement("div");
                cell.classList.add("element");
                cell.ondblclick = () => alert(`${element.name} (${element.symbol})`);

                cell.onclick = () => {
                    if (selectedElements.has(element.symbol)) {
                        selectedElements.delete(element.symbol);
                        cell.classList.remove("selected");
                    } else {
                        selectedElements.add(element.symbol);
                        cell.classList.add("selected");
                    }
                    console.log("Selected Elements:", Array.from(selectedElements));
                };


                if (element) {
                    cell.innerHTML = `<div class='symbol'>${element.symbol}</div><div class='name'>${element.name}</div>`;

                    if (selectedElements.has(element.symbol)) {
                            cell.classList.add("selected");
                        }

                } else {
                    cell.classList.add("empty");
                }
                table.appendChild(cell);
            }
        }



        //FOR MODAL
        document.querySelector(".PeriodicTableModal").onclick = () => {
          document.getElementById("modal-periodic-table").style.display = "flex";
        };

        document.querySelector(".modal-content-periodic-table .close").onclick = () => {
            document.getElementById("modal-periodic-table").style.display = "none";
        };

        window.onclick = (event) => {
            if (event.target === document.getElementById("modal-periodic-table")) {
                document.getElementById("modal-periodic-table").style.display = "none";
            }
        };

    </script>


</body>
</html>
