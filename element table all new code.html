<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Searchable Welding Wire Table</title>
    <style>

        @font-face {
              font-family: 'Montserrat-Medium';
              src: url('Montserrat/static/Montserrat-Medium.ttf') format('truetype');
              font-weight: 500; /* Medium weight */
              font-style: normal;
          }
          body {
              font-family: Arial, sans-serif;
              font-family: 'Montserrat-Medium', sans-serif;
              margin: 20px;
              background-color: #f4f4f4;
              text-align: center;
          }
        h2 {
            margin-bottom: 25px;
            margin-top: 30px;
        }
        input {
            padding: 6px 0;
            width:90%;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 5px;
            height: 15px;
            text-align: center;
        }

        .controls{
          display: flex;
          justify-content: center; /* Centers horizontally */
          align-items: center;     /* Centers vertically */
          margin-bottom: 20px;
          gap: 16px;
       }

        .table-container {
            width: 98%;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            height: 67vh; /* Fixed height of the table container */
            overflow-y: auto; /* Enable vertical scrolling */
            margin-bottom: 22px;
        }

        .table-container.query{
            height: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 15px 7px;
            font-size: 14px;
            border-left: 1px solid #ddd; /* Adds left border */
            border-right: 1px solid #ddd; /* Adds right border */
            border-top: none; /* Removes top border */
            border-bottom: none;
        }

        table th:not(:last-child),
        table td:not(:last-child) {
            text-align: center;
        }

        th {
            background-color: #98D8EF;
            color: white;
            align-items: center;
            text-align: center;
            cursor: pointer;
            position: sticky;
            top: 0; /* Make header sticky */
            z-index: 0; /* Ensure header stays above table content - was 1 i changed to 0 */
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .sort-icon {
            margin-left: 5px;
            font-size: 12px;
        }
        tr:hover {
            background-color: #e0f7fa;
        }

        /* Modal Styles */
        #modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            width: 50%;
        }
        .modal-header {
            font-size: 24px;
            margin-bottom: 10px;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
        }
        br {
            display: block;
            content: "";
            margin-bottom: 10px; /* Adjust the space */
        }
        .highlighted {
            background-color: #FFD95F !important;
        }

        .section a{
          color: #3674B5;
          margin-left: 12px;
          margin-right: 12px;
          text-align: center;
          font-size: 14px;
          text-transform: uppercase;
          text-decoration: none;
       }

       ul {
         list-style-type: none;
         text-align: left;
         padding-left: 25px; /* remove default padding */
      }
       li {
         padding: 5px 0;
         font-size: 13px;
       }
       h4{
         padding-left: 25px;
       }

       .clearButton{
          display: none;
          cursor: pointer;
          font-size: 26px;
          color: gray;
          padding-left: 6px;
       }

       .btn {
        background-color: #578FCA;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        width: 160px;
        font-size: 15px;
        font-weight: bold;
      }
      .btn:hover{
        background-color: #493D9E;
      }
      .clear-btn {
        background-color: #ff4c4c;
        width: 120px;
      }
      .clear-btn:hover {
        background-color: #cc0000;
      }
      .custom-file-upload {
        display: inline-block;
        padding: 8px 15px;
        background-color: #4caf50;
        color: white;
        font-size: 15px;
        font-weight: bold;
        text-align: center;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }
      .export-btn{
        background-color: #4caf50;
      }
      .custom-file-upload:hover {
        background-color: #45a049;
      }
      .export-btn:hover {
        background-color: #45a049;
      }


      input[type="file"] {
        display: none;
      }
      input.small{
        width: 60px;
      }
      .highlight {
        background-color: #ffd95f !important; /* Change color as needed */
      }

      .error-message {
          color: red;
          font-size: 11px;
          display: block;
          margin-top: 2px;
        }

    </style>


</head>
<body>

    <h2>Search Material By Chemical Composition</h2>
    <div class="controls">
        <label for="sensitivity">Sensitivity, %:</label>
        <input class="small" type="number" id="sensitivity" min="0" max="100" value="15">
        <button class="btn clear-btn" onclick="clearInputs()">Clear All</button>
        <button class="btn toggle-btn" id="toggleButton" onclick="toggleBalanceValues()">Toggle Balances</button>
        <button class="btn search-btn" onclick="filterTable()">Search Similar</button>
        <button class="btn insert-btn" id="saveButton">Insert to Table</button>
        <button class="btn save-btn" onclick="saveHtmlToFile()">Save file</button>
        <button class="btn export-btn" id="exportCSV">Export to CSV</button>
        <label for="importCSV" class="custom-file-upload">
          <span>Import a CSV file</span>
          <input type="file" id="importCSV">
        </label>
  </div>


     <div class="table-container query">
        <table id="query-table">
            <thead>
              <tr>
                <th class="maxWide">Material</th>
                <th>Nickel</th>
                <th>Cobalt</th>
                <th>Chromium</th>
                <th>Molybdenum</th>
                <th>Niobium</th>
                <th>Titanium</th>
                <th>Aluminum</th>
                <th>Tungsten</th>
                <th>Iron</th>
                <th>Carbon</th>
                <th>Manganese</th>
                <th>Silicon</th>
                <th>Tin</th>
                <th>Vanadium</th>
                <th>Zirconium</th>
                <th>Boron</th>
                <th>Silver</th>
                <th>Copper</th>
                <th>Zinc</th>
                <th>Magnesium</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td class="maxWide">
                  <input type="text" id="materialSearch" placeholder="Search material...">
                </td>
                <td>
                  <input type="text" class="filter" data-col="1" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="2" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="3" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="4" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="5" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="6" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="7" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="8" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="9" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="10" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="11" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="12" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="13" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="14" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="15" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="16" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="17" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="18" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="19" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
                <td>
                  <input type="text" class="filter" data-col="20" oninput="validateInput(this)">
                  <span class="error-message"></span>
                </td>
              </tr>
            </tbody>
          </table>
    </div>

    <div class="table-container">
        <table id="data-table">
            <thead>


          <tr>
            <th onclick="sortTable(0)">
              Material <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(1)">
              Nickel (Ni) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(2)">
              Cobalt (Co) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(3)">
              Chromium (Cr) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(4)">
              Molybdenum (Mo) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(5)">
              Niobium (Nb) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(6)">
              Titanium (Ti) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(7)">
              Aluminum (Al) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(8)">
              Tungsten (W) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(9)">
              Iron (Fe) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(10)">
              Carbon (C) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(11)">
              Manganese (Mn) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(12)">
              Silicon (Si) % <span class="sort-icon">⇅</span>
            </th>

            <th onclick="sortTable(13)">
              Tin (Sn) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(14)">
              Vanadium (V) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(15)">
              Zirconium (Zr) % <span class="sort-icon">⇅</span>
            </th>

            <th onclick="sortTable(16)">
              Boron (B) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(17)">
              Silver (Ag) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(18)">
              Copper (Cu) %<span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(19)">
              Zinc (Zn) % <span class="sort-icon">⇅</span>
            </th>
            <th onclick="sortTable(20)">
              Magnesium (Mg) % <span class="sort-icon">⇅</span>
            </th>
          </tr>


            </thead>
            <tbody>

          <tr>
            <td>CRES 304</td>
            <td>8.0 - 10.5</td>
            <td>-</td>
            <td>18.0 - 20.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Bal.</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 308</td>
            <td>11.0</td>
            <td>-</td>
            <td>19.0 - 21.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Bal.</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 316</td>
            <td>10.0 - 14.0</td>
            <td>-</td>
            <td>16.0 - 18.0</td>
            <td>2.0 - 3.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Bal.</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 321</td>
            <td>9.0 - 12.0</td>
            <td>-</td>
            <td>17.0 - 19.0</td>
            <td>-</td>
            <td>5.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Bal.</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 347</td>
            <td>9.0 - 12.0</td>
            <td>-</td>
            <td>17.0 - 19.0</td>
            <td>-</td>
            <td>10.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>62.0</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>0.8</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>CRES 410</td>
            <td>0.75</td>
            <td>-</td>
            <td>11.5 - 13.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>88.0</td>
            <td>0.08 - 0.15</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>René 41</td>
            <td>54.0</td>
            <td>10.0 - 12.0</td>
            <td>18.0 - 20.0</td>
            <td>9.0 - 10.5</td>
            <td>-</td>
            <td>3.0 - 3.3</td>
            <td>1.4 - 1.6</td>
            <td>-</td>
            <td>5.0</td>
            <td>0.05 - 0.12</td>
            <td>0.003 - 0.010</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Rene 77</td>
            <td>62.0</td>
            <td>14-16</td>
            <td>14-16</td>
            <td>4-5</td>
            <td>-</td>
            <td>2.5-3.2</td>
            <td>3.8-4.8</td>
            <td>-</td>
            <td>-</td>
            <td>0.08-0.15</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>René 80</td>
            <td>56.0</td>
            <td>9.5 - 10.5</td>
            <td>19.0 - 21.0</td>
            <td>9.0 - 10.0</td>
            <td>-</td>
            <td>2.6 - 3.1</td>
            <td>1.4 - 1.6</td>
            <td>-</td>
            <td>5.0</td>
            <td>0.05 - 0.10</td>
            <td>0.003 - 0.010</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Waspaloy</td>
            <td>53.0 - 59.0</td>
            <td>9.0 - 11.0</td>
            <td>19.0 - 21.0</td>
            <td>1.5 - 2.5</td>
            <td>-</td>
            <td>3.0 - 3.5</td>
            <td>1.0 - 1.5</td>
            <td>-</td>
            <td>1.0 - 5.0</td>
            <td>0.05 - 0.15</td>
            <td>0.003 - 0.010</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>

          <tr>
            <td>Inconel 100</td>
            <td>64.0</td>
            <td>15-16.5</td>
            <td>9-11</td>
            <td>3-4</td>
            <td>-</td>
            <td>4.3-4.7</td>
            <td>4.8-5.2</td>
            <td>-</td>
            <td>≤1</td>
            <td>0.17-0.23</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 600</td>
            <td>72.0</td>
            <td>-</td>
            <td>14-17</td>
            <td>-</td>
            <td>-</td>
            <td>0.3</td>
            <td>0.2-0.4</td>
            <td>-</td>
            <td>6-10</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 601</td>
            <td>58-63</td>
            <td>1.0</td>
            <td>21-25</td>
            <td>≤1</td>
            <td>-</td>
            <td>0.3-1.5</td>
            <td>1-1.7</td>
            <td>-</td>
            <td>17.0</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 602</td>
            <td>63.0</td>
            <td>1.5</td>
            <td>24.0-26.0</td>
            <td>8.5-9</td>
            <td>-</td>
            <td>0.15-0.25</td>
            <td>1.8-2.4</td>
            <td>-</td>
            <td>≤3</td>
            <td>0.1</td>
            <td>0.1</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 625</td>
            <td>58.0</td>
            <td>1.0</td>
            <td>20-23</td>
            <td>8-10</td>
            <td>3.15-4.15</td>
            <td>0.4</td>
            <td>0.4</td>
            <td>-</td>
            <td>5.0</td>
            <td>0.1</td>
            <td>0.5</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 713</td>
            <td>76.0</td>
            <td>0.5</td>
            <td>12.5-13.5</td>
            <td>4.2-4.8</td>
            <td>-</td>
            <td>0.5-0.8</td>
            <td>5.5-6.5</td>
            <td>-</td>
            <td>76.0</td>
            <td>0.08-0.2</td>
            <td>0.1</td>
            <td>0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Inconel 718</td>
            <td>50.0-55.0</td>
            <td>1.0</td>
            <td>17.0-21.0</td>
            <td>2.8-3.3</td>
            <td>4.75-5.5</td>
            <td>0.65-1.15</td>
            <td>0.2-0.8</td>
            <td>-</td>
            <td>23.0</td>
            <td>0.1</td>
            <td>0.3</td>
            <td>0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Hastelloy X</td>
            <td>47.5-52.0</td>
            <td>1.5</td>
            <td>20.5-23</td>
            <td>8-10</td>
            <td>-</td>
            <td>-</td>
            <td>0.5</td>
            <td>-</td>
            <td>17.0-20.0</td>
            <td>0.05-0.15</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Hastelloy W</td>
            <td>56.0</td>
            <td>5.0</td>
            <td>4.5-7</td>
            <td>24.0-28.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>4.0-6.0</td>
            <td>5.0</td>
            <td>0.05-0.15</td>
            <td>1.0</td>
            <td>0.2</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>L605</td>
            <td>10.0</td>
            <td>49.0-53.0</td>
            <td>19-21</td>
            <td>1.0-2.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>14.0-16.0</td>
            <td>3.0</td>
            <td>0.05-0.15</td>
            <td>1.0</td>
            <td>0.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Haynes 188</td>
            <td>22.0</td>
            <td>37.0</td>
            <td>20.0-24.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>13.0-16.0</td>
            <td>3.0</td>
            <td>0.05-0.15</td>
            <td>1.3</td>
            <td>0.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Haynes 230</td>
            <td>57.0</td>
            <td>5.0</td>
            <td>20.0-24.0</td>
            <td>1.5-3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>14.0</td>
            <td>3.0</td>
            <td>0.05-0.15</td>
            <td>0.3-0.6</td>
            <td>0.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>X-750</td>
            <td>70.0</td>
            <td>1.0</td>
            <td>14.0-17.0</td>
            <td>0.7-1.2</td>
            <td>0.7-1.2</td>
            <td>2.25-2.75</td>
            <td>0.4-1</td>
            <td>-</td>
            <td>5-9</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Greek Ascoloy</td>
            <td>-</td>
            <td>-</td>
            <td>12.0-14.0</td>
            <td>-</td>
            <td>-</td>
            <td>2.75-3.25</td>
            <td>-</td>
            <td>-</td>
            <td>84.0</td>
            <td>0.15-0.2</td>
            <td>0.5</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>17-4 PH</td>
            <td>3.0-5.0</td>
            <td>-</td>
            <td>15.0-17.5</td>
            <td>-</td>
            <td>-</td>
            <td>0.15-0.45</td>
            <td>-</td>
            <td>-</td>
            <td>63.0</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>15-5 PH</td>
            <td>3.5-5.5</td>
            <td>-</td>
            <td>14.0-15.5</td>
            <td>-</td>
            <td>-</td>
            <td>0.9</td>
            <td>-</td>
            <td>-</td>
            <td>65.0</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>A286</td>
            <td>24.0-27.0</td>
            <td>-</td>
            <td>13.5-16</td>
            <td>1.0-1.5</td>
            <td>-</td>
            <td>1.9-2.3</td>
            <td>0.1-0.5</td>
            <td>-</td>
            <td>56.0</td>
            <td>0.1</td>
            <td>2.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>C263</td>
            <td>52.0</td>
            <td>20.0</td>
            <td>19-21</td>
            <td>5.6-6.1</td>
            <td>-</td>
            <td>2-2.4</td>
            <td>0.6</td>
            <td>-</td>
            <td>52.0</td>
            <td>0.0</td>
            <td>0.6</td>
            <td>0.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>C276</td>
            <td>60.0</td>
            <td>2.5</td>
            <td>14.5-16.5</td>
            <td>15-17</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>3-4.5</td>
            <td>4-7</td>
            <td>0.0</td>
            <td>1.0</td>
            <td>0.1</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Steel 4340</td>
            <td>-</td>
            <td>-</td>
            <td>0.7-0.9</td>
            <td>0.2-0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>98.0</td>
            <td>0.38-0.43</td>
            <td>0.6-0.8</td>
            <td>0.15-0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Steel 4130</td>
            <td>-</td>
            <td>-</td>
            <td>0.8-1.1</td>
            <td>0.15-0.25</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>98.0</td>
            <td>0.28-0.33</td>
            <td>0.4-0.6</td>
            <td>0.15-0.3</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Marm-200</td>
            <td>72.0</td>
            <td>10.0</td>
            <td>9.0</td>
            <td>2.0</td>
            <td>-</td>
            <td>5.0</td>
            <td>2.0</td>
            <td>-</td>
            <td>-</td>
            <td>0.1</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Coast Metal 64</td>
            <td>5</td>
            <td>43.6</td>
            <td>28</td>
            <td>0.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>21</td>
            <td>-</td>
            <td>0.85</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>1</td>
            <td>-</td>
            <td>0.05</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Tribaloy 800</td>
            <td>-</td>
            <td>50.6</td>
            <td>17.5</td>
            <td>28.5</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>3.4</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Stellite 31 (X40)</td>
            <td>10.5</td>
            <td>51.0</td>
            <td>26.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>7.5</td>
            <td>3.0</td>
            <td>0.1</td>
            <td>1.0</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 8Al 1Mo 1V</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>1.0</td>
            <td>-</td>
            <td>90.0</td>
            <td>8.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>1.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 6Al 4V ELI</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>90.0</td>
            <td>6.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>4.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 6Al 4V</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>90.0</td>
            <td>6.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>4.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 6Al 2Sn 4Zr 2Mo</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>2.0</td>
            <td>-</td>
            <td>86.0</td>
            <td>6.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>2.0</td>
            <td>-</td>
            <td>4.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Titanium 15V 3Cr 3Sn 3Al</td>
            <td>-</td>
            <td>-</td>
            <td>3.0</td>
            <td>-</td>
            <td>-</td>
            <td>76.0</td>
            <td>3.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>3.0</td>
            <td>15.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Silver Flo 55</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>2.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>55.0</td>
            <td>21.0</td>
            <td>22.0</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Silver Flo 56 (AMS 4763)</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>5.0</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>56.0</td>
            <td>22.0</td>
            <td>17.0</td>
            <td>-</td>
          </tr>
            <tr>
              <td>BAg-24 (AMS 4788)</td><td>2.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>50.0</td><td>20.0</td><td>28.0</td>  <td>-</td>
              </tr>
              <tr>
                <td>BAg-13 (AMS 4772)</td><td>1.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>54.0</td><td>40.0</td><td>5.0</td>  <td>-</td>
              </tr>
              <tr>
                <td>BAg-13a (AMS 4765)</td><td>2.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>56.0</td><td>42.0</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-5 (AMS 4782)</td><td>71.0</td><td>-</td><td>19.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>10.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-1 (AMS 4775)</td><td>73.0</td><td>-</td><td>14.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>4.5</td><td>0.8</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>-</td><td>3.0</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-1a (AMS 4776)</td><td>74.0</td><td>-</td><td>14.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-2 (AMS 4777)</td><td>82.4</td><td>-</td><td>7.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>3.0</td><td>-</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>-</td><td>3.1</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-3 (AMS 4778)</td><td>92.0</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>4.5</td><td>-</td><td>-</td><td>-</td><td>3.0</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
              <tr>
                <td>BNi-4 (AMS 4779)</td><td>94.6</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>3.5</td><td>-</td><td>-</td><td>-</td><td>1.9</td><td>-</td><td>-</td><td>-</td>  <td>-</td>
              </tr>
            <tr>
              <td>Al 2024</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>93</td><td>-</td><td>0.5</td><td>-</td><td>-</td><td>0.5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>4.9</td><td>-</td><td>-</td>
            </tr>
              <tr>
                <td>Al 6061</td><td>-</td><td>-</td><td>0.2</td><td>-</td><td>-</td><td>-</td><td>97.9</td><td>-</td><td>-</td><td>-</td><td>-</td><td>0.6</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>0.28</td><td>-</td><td>1</td>
              </tr>
              <tr>
                <td>Al 7075</td><td>-</td><td>-</td><td>0.2</td><td>-</td><td>-</td><td>-</td><td>91</td><td>-</td><td>-</td><td>-</td><td>-</td><td>0.6</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>1.4</td><td>5.6</td><td>2.1</td>
              </tr>
              <tr>
                <td>Al A413</td><td>0.5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>94</td><td>-</td><td>-</td><td>-</td><td>0.35</td><td>12</td><td>0.15</td><td>-</td><td>-</td><td>-</td><td>-</td><td>1</td><td>-</td><td>0.1</td>
            </tr>
            <tr>
              <td>Al 4043</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>93.9</td><td>-</td><td>-</td><td>-</td><td>-</td><td>5.2</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td>
            </tr>
            <tr>
              <td>Al 5052</td><td>-</td><td>-</td><td>0.25</td><td>-</td><td>-</td><td>-</td><td>97.2</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>2.5</td>
            </tr>
            <tr>
              <td>Al 5Si 1.3Cu 0.5Mg</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>93.2</td><td>-</td><td>-</td><td>-</td><td>-</td><td>5</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>1.3</td><td>-</td><td>0.5</td>
            </tr>
          </tbody>

            </tbody>
        </table>

    </div>

    <script>

        document.addEventListener("DOMContentLoaded", function () {

          //search bar
        document.getElementById("materialSearch").addEventListener("input", function () {
            let searchValue = this.value.toLowerCase();
            document.querySelectorAll("#data-table tbody tr")
              .forEach((row) => {
                let material = row.cells[0].textContent.toLowerCase();
                row.style.display = material.includes(searchValue)
                  ? ""
                  : "none";
              });
          });
       });


      //filter table
      function filterTable() {
        let filters = document.querySelectorAll(".filter");
        let rows = document.querySelectorAll(
          "#data-table tbody tr"
        );
        console.log(rows)
        let sensitivity =
          parseFloat(document.getElementById("sensitivity").value) || 1;

        rows.forEach((row) => {
          let cells = row.getElementsByTagName("td");
          let showRow = true;

          filters.forEach((filter) => {
            let colIndex = filter.getAttribute("data-col");
            let filterValue = filter.value.trim();
            let cellText = cells[colIndex].textContent.trim();

            // If filter is empty, ignore filtering for this column
            if (filterValue === "") return;

            // Ignore rows where the cell is just "-"
            if (cellText === "-") {
              showRow = false;
              return;
            }

            let cellValue;
            if (cellText.includes("-")) {
              // Handle range values like "10 - 14"
              let [min, max] = cellText
                .split("-")
                .map((num) => parseFloat(num.trim()));
              if (!isNaN(min) && !isNaN(max)) {
                cellValue = [min, max]; // Store range for filtering
              } else {
                cellValue = parseFloat(cellText); // Fallback in case of malformed data
              }
            } else {
              cellValue = parseFloat(cellText);
            }

            // Ensure valid number input
            if (!isNaN(parseFloat(filterValue))) {
              let lowerBound =
                parseFloat(filterValue) -
                (parseFloat(filterValue) * sensitivity) / 100;
              let upperBound =
                parseFloat(filterValue) +
                (parseFloat(filterValue) * sensitivity) / 100;

              if (Array.isArray(cellValue)) {
                // Filter using both min and max values of the range
                if (cellValue[1] < lowerBound || cellValue[0] > upperBound) {
                  showRow = false;
                }
              } else if (!isNaN(cellValue)) {
                if (cellValue < lowerBound || cellValue > upperBound) {
                  showRow = false;
                }
              }
            }
          });

          row.style.display = showRow ? "" : "none";
        });
      }


      //double click row to copy data
      document.querySelectorAll("#data-table tr").forEach((row) => {
        row.addEventListener("dblclick", function () {
          let cells = this.getElementsByTagName("td");
          let inputs = document.querySelectorAll("#query-table input");

          inputs.forEach((input, index) => {
            let cellText = cells[index] ? cells[index].textContent.trim() : "";

            // First column: copy as-is, Other columns: only copy if it's a number
            if (index === 0) {
              input.value = cellText; // Copy first column as-is
            } else {
              let cellValue = parseFloat(cellText);
              input.value = !isNaN(cellValue) ? cellValue : "";
            }
          });
        });
      });


      let sortDirections = {}; // Store sort directions for each column

      //sort columns
      function sortTable(colIndex) {
        let table = document.getElementById("data-table");
        let tbody = table.querySelector("tbody"); // Ensure tbody is selected
        let rows = Array.from(tbody.rows); // Get only tbody rows (skip the header)

      
        // Default to descending order if first click, otherwise toggle
        if (sortDirections[colIndex] === undefined) {
            sortDirections[colIndex] = false; // Start with descending order
        } else {
            sortDirections[colIndex] = !sortDirections[colIndex]; // Toggle order on next click
        }

        let isAscending = sortDirections[colIndex];

        rows.sort((rowA, rowB) => {
            let cellA = rowA.cells[colIndex].textContent.trim();
            let cellB = rowB.cells[colIndex].textContent.trim();

            let valueA = parseCellValue(cellA, rowA, colIndex);
            let valueB = parseCellValue(cellB, rowB, colIndex);

            return isAscending ? valueA - valueB : valueB - valueA;
        });

            // Clear tbody and reappend sorted rows
            tbody.innerHTML = "";
            rows.forEach(row => tbody.appendChild(row));
    }


        // Parse cell value to handle ranges and other types of values
        function parseCellValue(value, row = null, colIndex = null) {
            value = value.trim();

            if (value === "-") return 0; // "-" is treated as zero

            if (value.toLowerCase() === "bal." || value.toLowerCase() === "balance") {
                return calculateBalance(row, colIndex); // Compute balance dynamically
            }

            // Remove all spaces from the range
            let cleanValue = value.replace(/\s+/g, '');

            // Check if the value is a range (e.g., "9.0-12.0")
            if (cleanValue.includes('-') && /^[0-9]+(\.[0-9]+)?-[0-9]+(\.[0-9]+)?$/.test(cleanValue)) {
                let parts = cleanValue.split('-').map(Number);
                // Calculate and return the average of the two values in the range
                return (parts[0] + parts[1]) / 2; // Average of range
            }

            // For regular numbers or any other text
            return parseFloat(value) || 0; // Convert to number, default to 0
        }

        // Calculate balance from row by summing other cell values
        function calculateBalance(row, colIndex) {
            let total = 0;
            for (let i = 0; i < row.cells.length; i++) {
                if (i !== colIndex) { // Exclude balance column itself
                    let cellValue = row.cells[i].textContent.trim();
                    let numValue = parseCellValue(cellValue); // Parse each cell's value
                    total += numValue;
                }
            }
            return 100 - total; // Balance is 100 - SUM(other values)
        }



            //clear all inputs
            function clearInputs() {
              document
                .querySelectorAll("#query-table input")
                .forEach((input) => (input.value = ""));
              document
                .querySelectorAll("#data-table tr")
                .forEach((row) => (row.style.display = ""));
            }



            //Highlight row on click
            document.querySelectorAll("#data-table tbody tr")
              .forEach((row) => {
                row.addEventListener("click", function (event) {
                  let isHighlighted = this.classList.contains("highlight");

                  // Remove highlight from all rows
                  document.querySelectorAll("#data-table tbody tr")
                    .forEach((r) => r.classList.remove("highlight"));

                  // Toggle highlight on the clicked row
                  if (!isHighlighted) {
                    this.classList.add("highlight");
                  }

                  // Stop click from propagating to the document listener
                  event.stopPropagation();
                });
              });



      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("saveButton")
          .addEventListener("click", function () {
            let materialName = document
              .getElementById("materialSearch")
              .value.trim();
            if (!materialName) {
              alert("Please enter a material name.");
              return;
            }

            let dataTable = document
              .getElementById("data-table")
              .getElementsByTagName("tbody")[0];
            let rows = dataTable.getElementsByTagName("tr");
            let found = false;

            // Get input values from query-table
            let inputs = document.querySelectorAll("#query-table .filter");
            let values = Array.from(inputs).map(
              (input) => input.value.trim() || "-"
            );

            for (let i = 1; i < rows.length; i++) {
              // Start from 1 to skip headers
              let row = rows[i];
              let firstCell = row.cells[0];

              if (firstCell.textContent.trim() === materialName) {
                // ✅ Update existing row (ALL columns)
                for (let j = 0; j < values.length; j++) {
                  row.cells[j + 1].textContent = values[j]; // Skip material column
                }
                found = true;
                break;
              }
            }

            if (!found) {
              // ✅ Add new row
              let newRow = dataTable.insertRow();

              // Insert material name
              let nameCell = newRow.insertCell(0);
              nameCell.textContent = materialName;

              // Insert all values
              values.forEach((value) => {
                let cell = newRow.insertCell();
                cell.textContent = value;
              });
            }
          });
      });


      //export table to csv
      document.getElementById("exportCSV").addEventListener("click", function () {
          let dataTable = document.getElementById("data-table");
          let rows = dataTable.getElementsByTagName("tr");
          let csvContent = [];

          for (let i = 0; i < rows.length; i++) {
            let row = rows[i];
            let cells =
              row.getElementsByTagName("th").length > 0
                ? row.getElementsByTagName("th")
                : row.getElementsByTagName("td");
            let rowData = Array.from(cells)
              .map((cell) => `"${cell.textContent.trim()}"`)
              .join(",");
            csvContent.push(rowData);
          }

          let csvBlob = new Blob([csvContent.join("\n")], { type: "text/csv" });
          let link = document.createElement("a");
          link.href = URL.createObjectURL(csvBlob);
          link.download = "materials database.csv";
          link.click();
        });


           
        document.getElementById("importCSV").addEventListener("change", function (event) {
                  let file = event.target.files[0];
                  if (!file) return;

                  let reader = new FileReader();
                  reader.onload = function (e) {
                      loadCSVData(e.target.result);
                       event.target.value = ""; // Reset input so the same file can be selected again
                  };
                  reader.readAsText(file);
              });
           

                
              //save new html file
      function saveHtmlToFile() {
        // Get the HTML content of the page
        const htmlContent = document.documentElement.outerHTML;

                // Get today's date in dd/mm/yyyy format
        const today = new Date();
        const day = String(today.getDate()).padStart(2, '0');
        const month = String(today.getMonth() + 1).padStart(2, '0'); // Months are 0-based
        const year = today.getFullYear();
        const dateStr = `${day}-${month}-${year}`;

        // Use a default file name (you can change this if needed)
        const fileName = `page_${dateStr}.html`;

        // Add the DOCTYPE declaration before the HTML content
        const doctype = `<!DOCTYPE html>\n`;
        const fullHtmlContent = doctype + htmlContent;

        // Create a Blob from the HTML content
        const blob = new Blob([fullHtmlContent], { type: "text/plain" });

        // Create an anchor element to trigger the download
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = fileName; // Name of the file to save

        // Trigger the download
        link.click();
      }



      //Shrink header columns on click, to allow easier edit
      document.addEventListener("DOMContentLoaded", function () {
          const elementMap = {
              "Nickel": "Ni",
              "Cobalt": "Co",
              "Chromium": "Cr",
              "Molybdenum": "Mo",
              "Niobium": "Nb",
              "Titanium": "Ti",
              "Aluminum": "Al",
              "Tungsten": "W",
              "Iron": "Fe",
              "Carbon": "C",
              "Manganese": "Mn",
              "Silicon": "Si",
              "Tin": "Sn",
              "Vanadium": "V",
              "Zirconium": "Zr",
              "Boron": "B",
              "Silver": "Ag",
              "Copper": "Cu",
              "Zinc": "Zn",
              "Magnesium": "Mg"
          };

          const tableHeaders = document.querySelectorAll("#query-table th");

          tableHeaders.forEach(header => {
              header.addEventListener("click", function () {
                  const fullName = this.textContent;

                  if (elementMap[fullName]) {
                      this.textContent = elementMap[fullName];
                      this.style.width = "20px";

                  } else {
                      const shortName = Object.values(elementMap).find(short => short === fullName);
                      if (shortName) {
                          const longName = Object.keys(elementMap).find(key => elementMap[key] === shortName);
                          this.textContent = longName;
                      }
                  }
              });
          });
      });


      //validation input
      function validateInput(input) {
          const firstColumn = input.closest("tr").querySelector("td:first-child input"); // First column input
          if (input === firstColumn) return; // Skip validation for first column

          const value = input.value.trim();
          const errorMessage = input.nextElementSibling; 
          const validNumberRegex = /^(\d{1,2}(\.\d+)?|100)$/; // Matches numbers from 0 to 100, including decimals
          const validRangeRegex = /^(\d{1,2}(\.\d+)?|100) *- *(\d{1,2}(\.\d+)?|100)$/; // Matches range like 1 - 2.5
          const validBal = /^Bal\.$/i; // Matches the word "Bal."

          if (value === "" || validNumberRegex.test(value) || validRangeRegex.test(value) || validBal.test(value)) {
            errorMessage.textContent = ""; // Clear error if valid
            input.style.border = "1px solid #ccc";
            filterTable();
          } else {
            errorMessage.textContent = "Invalid input (0-100, range, or 'Bal.')";
            input.style.border = "1px solid red";
          }
        }


        // Function to toggle between "Bal." and the calculated value in the table
        function toggleBalanceValues() {
            const table = document.querySelector('#data-table'); // Assuming you're working with a table element
            const cells = table.querySelectorAll('td');

            cells.forEach(cell => {
                if (cell.textContent.trim().toLowerCase() === 'bal.' || cell.textContent.trim().toLowerCase() === 'balance') {
                   
                        // If not converted, calculate and replace it with the value
                        const row = cell.closest('tr');
                        const colIndex = Array.from(cell.parentElement.children).indexOf(cell);
                        const balance = calculateBalance(row, colIndex);
                        cell.textContent = balance.toFixed(2); // Assuming balance is a number to 2 decimal places
                        cell.setAttribute('data-converted', 'true'); // Mark this cell as converted

                }else if (cell.hasAttribute('data-converted')) {
                        // If already converted, revert it back to "Bal."
                        cell.textContent = "Bal.";
                        cell.removeAttribute('data-converted'); // Remove the marker
                    }
            });
        }

    </script>


</body>
</html>
